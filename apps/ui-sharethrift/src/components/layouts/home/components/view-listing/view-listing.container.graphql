# View Listing Query (backend-aligned)

fragment ViewListingContainerListingFields on ItemListing {
  id
  title
  description
  category
  listingType
  location
  sharingPeriodStart
  sharingPeriodEnd
  state
  images
  createdAt
  updatedAt
  reports
  sharingHistory
  schemaVersion
}

query ViewListing($id: ObjectID!) {
  itemListing(id: $id) {
    ...ViewListingContainerListingFields
  }
}

query ViewListingCurrentUser {
  currentPersonalUserAndCreateIfNotExists {
    ...ViewListingContainerUserFields
  }
}

fragment ViewListingContainerUserFields on PersonalUser {
  id
}

fragment ViewListingContainerReservationFields on ReservationRequest {
  id
  state
  reservationPeriodStart
  reservationPeriodEnd
}

query ViewListingActiveReservationRequestForListing(
  $listingId: ObjectID!
  $reserverId: ObjectID!
) {
  myActiveReservationForListing(listingId: $listingId, userId: $reserverId) {
    ...ViewListingContainerReservationFields
  }
}
