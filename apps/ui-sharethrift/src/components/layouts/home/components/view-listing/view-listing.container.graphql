# View Listing Query (backend-aligned)

fragment ViewListingContainerListingFields on ItemListing {
  id
  title
  description
  category
  listingType
  location
  sharingPeriodStart
  sharingPeriodEnd
  state
  images
  createdAt
  updatedAt
  reports
  sharingHistory
  schemaVersion
  sharer {
    ... on PersonalUser {
      id
      account {
        profile {
          firstName
          lastName
        }
      }
    }
    ... on AdminUser {
      id
      account {
        profile {
          firstName
          lastName
        }
      }
    }
  }
}

query ViewListing($id: ObjectID!) {
  itemListing(id: $id) {
    ...ViewListingContainerListingFields
  }
}

query ViewListingCurrentUser {
  currentUser {
    ... on PersonalUser {
      id
      userType
      userIsAdmin
    }
    ... on AdminUser {
      id
      userType
      userIsAdmin
    }
  }
}

fragment ViewListingContainerReservationFields on ReservationRequest {
  id
  state
  reservationPeriodStart
  reservationPeriodEnd
}

query ViewListingActiveReservationRequestForListing(
  $listingId: ObjectID!
  $reserverId: ObjectID!
) {
  myActiveReservationForListing(listingId: $listingId, userId: $reserverId) {
    ...ViewListingContainerReservationFields
  }
}
